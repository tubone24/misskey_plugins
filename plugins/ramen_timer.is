///@ 0.12.4
// è‡ªç”±ã«è¤‡è£½ãƒ»æ”¹å¤‰ã—ã¦ã„ãŸã ã„ã¦æ§‹ã„ã¾ã›ã‚“ã€‚
// CC0 1.0 https://creativecommons.org/publicdomain/zero/1.0/deed.ja
### {
  name: "ãƒ©ãƒ¼ãƒ¡ãƒ³ã‚¿ã‚¤ãƒãƒ¼"
  version: "1.0.0"
  author: "@716doremi"
  description: "ç¾å‘³ã—ã„ãƒ©ãƒ¼ãƒ¡ãƒ³ã‚’ä½œã‚ã†"
}

var ramenMin = 3
var ramenCountDown = 0

@start() {
  Mk:dialog("ãƒ©ãƒ¼ãƒ¡ãƒ³ä½œã‚‹ğŸœ" "ç¾å‘³ã—ã„ãƒ©ãƒ¼ãƒ¡ãƒ³ã‚’ä½œã‚ã†ï¼ï¼ğŸœ")
  let ramenMillSecond = ramenMin * 60 * 1000
  ramenCountDown = ramenMin * 60
  let stopInterval = Async:interval(1000, @() {
      Ui:render([
      	Ui:C:container({
      		align: 'center'
      		children: [
      			Ui:C:mfm({ text: `ãƒ©ãƒ¼ãƒ¡ãƒ³ä½œæˆä¸­...ğŸœ ã®ã“ã‚Š{ramenCountDown.to_str()} ç§’` })
  			    Ui:C:postFormButton({
  			    	text: "æŠ•ç¨¿ã™ã‚‹"
  			    	rounded: true
  			    	primary: true
  			    	form: {
  			    		text: `ãƒ©ãƒ¼ãƒ¡ãƒ³ä½œæˆä¸­...ğŸœ ã®ã“ã‚Š{ramenCountDown.to_str()} ç§’{Str:lf}#ãƒ©ãƒ¼ãƒ¡ãƒ³ä½œã‚‹ğŸœ{Str:lf}{THIS_URL}`
  			    	}
  			    })
      		]
      	})
     ])
     ramenCountDown = ramenCountDown - 1
  }, true)
  Async:timeout(ramenMillSecond, @() {
      stopInterval()
      Mk:dialog("å®Œæˆï¼ğŸœ" "ãƒ©ãƒ¼ãƒ¡ãƒ³ã§ããŸï¼ğŸœ")
      Ui:render([
      	Ui:C:container({
      		align: 'center'
      		children: [
      			Ui:C:mfm({ text: `{ramenMin}åˆ†å¾…ã£ã¦ãŠã„ã—ã„ãƒ©ãƒ¼ãƒ¡ãƒ³ã§ããŸï¼ğŸœğŸœğŸœğŸœğŸœğŸœğŸœ` })
      			Ui:C:postFormButton({
      				text: "æŠ•ç¨¿ã™ã‚‹"
      				rounded: true
      				primary: true
      				form: {
      					text: `{ramenMin}åˆ†å¾…ã£ã¦ãŠã„ã—ã„ãƒ©ãƒ¼ãƒ¡ãƒ³ã§ããŸï¼ğŸœğŸœğŸœğŸœğŸœğŸœğŸœ{Str:lf}#ãƒ©ãƒ¼ãƒ¡ãƒ³ä½œã‚‹ğŸœ{Str:lf}{THIS_URL}`
      				}
      			})
      		]
      	})
      ])
  })
}

// UI
Ui:render([
	Ui:C:container({
		align: 'center'
		children: [
			Ui:C:mfm({ text: "ãƒ©ãƒ¼ãƒ¡ãƒ³ä½œã‚‹ï¼" })
			Ui:C:buttons({
			buttons: [{
                text: "å§‹ã‚ã‚‹"
                primary: false
                rounded: false
                onClick: start
                }]
			})
			  Ui:C:numberInput({
              	onInput: @(number){ ramenMin = number }
              	default: 3
              	label: "åˆ†"
              	caption: "ä½•åˆ†å¾…ã¤ï¼Ÿ"
              })
		]
	})
])